library(lessR)
PieChart(Var1, hole = 0, values = "%", data = t0,
fill = c("darkkhaki", "pink"), main = "Gráfico pie de sexo")
summary(data$Edad)
Mode(data$Edad, na.rm = T)
hist(data$Edad, main = "Histograma de la variable Edad", xlab = "Edad", ylab = "Frecuencia", col = "lightblue")
Mode(data$Ingresos, na.rm = T)
table(data$Ingresos)
tabla_ingresos=table(data$Ingresos)
tabla_ingresos1=prop.table(tabla_ingresos)*100
round(tabla_ingresos1, digits = 2)
barplot(tabla_ingresos1, main = "Gráfico de Barras de ingresos",
xlab = "Nivel de ingresos",
ylab = "Porcentaje", col = "aquamarine3", border = "darkgreen")
summary(data$Ideologia)
tabla_ideologia=table(data$Ideologia)
tabla_ideologia1=prop.table(tabla_ideologia)*100
round(tabla_ideologia1, digits = 2)
barplot(tabla_ideologia1, main = "Gráfico de Barras",
xlab = "Ideología política",
ylab = "Porcentaje", col = "lightgreen", border = "darkgreen")
Mode(data$interes_pol, na.rm = T)
summary(data$interes_pol)
tabla_interes=table(data$interes_pol)
tabla_interes1=prop.table(tabla_interes)*100
round(tabla_interes1, digits = 2)
barplot(tabla_interes1, main = "Gráfico de barras de interés en la política",
xlab = "Interés en la política",
ylab = "Porcentaje", col = "darkgoldenrod3", border = "darkgoldenrod")
Mode(data$preo_guerra, na.rm = T)
tabla_preo=table(data$preo_guerra)
tabla_preo1=prop.table(tabla_preo)*100
round(tabla_preo1, digits = 2)
t3=as.data.frame(table(data$preo_guerra))
ggplot(t3,aes(x="Grado de preocupación por una guerra",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico de preocupación por una guerra")+xlab("") + ylab(" ")
library(DescTools)
Mode(data$lib_con,na.rm = T)
Median(data$lib_con,na.rm = T)
boxplot(data$`Q48: How much freedom of choice and control`, main="Boxplot de Libertad de elección y control", col = "darksalmon")
Mode(data$lib_igualdad,na.rm = T)
library(ggplot2)
t1=as.data.frame(table(data$lib_igualdad))
ggplot(t1,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable libertad o igualdad")+xlab("") + ylab(" ")
barplot(table(data$lib_igualdad),col="purple",
xlab=NULL,
ylab="Conteo de encuestados",
main="Libertad o igualdad")
t2=as.data.frame(table(data$lib_seguridad))
ggplot(t2,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable  libertad o seguridad")+xlab("") + ylab(" ")
barplot(table(data$lib_seguridad),col="pink",
xlab=NULL,
ylab="Conteo de encuestados",
main="libertad o seguridad")
Mode(data$objetivos_pais,na.rm = T)
t3=as.data.frame(table(data$objetivos_pais))
ggplot(t3,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable sobre los objetivos del país")+xlab("") + ylab(" ")
Mode(data$objetivos_encuestado,na.rm = T)
t4=as.data.frame(table(data$objetivos_encuestado))
ggplot(t4,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable objetivos de los encuestados")+xlab("") + ylab(" ")
Mode(data$democracia,na.rm = T)
Median(data$democracia,na.rm = T)
boxplot(data$democracia)
Mode(data$mundo,na.rm = T)
t5=as.data.frame(table(data$mundo))
ggplot(t5,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable proximidad al mundo")+xlab("") + ylab(" ")
Mode(data$educacion,na.rm = T)
t6=as.data.frame(table(data$educacion))
ggplot(t6,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable educación")+xlab("") + ylab(" ")
comp_prin=subset(data,select=c("ONU", "OEA", "FMI"))
comp_prin=comp_prin[complete.cases(comp_prin[ , 1:3]),]
library(polycor)
library(psych)
str(comp_prin)
cor(comp_prin)
library(corrplot)
corrplot(cor(comp_prin))
corrplot(cor(comp_prin), # Matriz de correlación
method = "shade", # Método para el gráfico de correlación
type = "full", # Estilo del gráfico (también "upper" y "lower")
diag = TRUE, # Si TRUE (por defecto), añade la diagonal
tl.col = "black", # Color de las etiquetas
bg = "white", # Color de fondo
title = "",
col = NULL)
# pruebas
library(psych)
psych::KMO(comp_prin)
corMatrix=cor(comp_prin)
cortest.bartlett(corMatrix,n=nrow(comp_prin))$p.value>0.05
fa.parallel(corMatrix, fm="pa", fa="pc", main = "Scree Plot")
library(FactoMineR)
res.pca <- PCA(comp_prin, graph = FALSE)
library(FactoMineR)
library(factoextra)
fviz_pca_var(res.pca, col.var = "black",repel = TRUE)
eig.val <-get_eig(res.pca)
eig.val
comp1<- pca(comp_prin,nfactors = 1,rotate = "varimax")
comp<-as.data.frame(comp1$scores)
View(comp)
comp1<- pca(comp_prin,nfactors = 1,rotate = "varimax")
comp<-as.data.frame(comp1$scores)
data$con_org<- comp$PC1
View(comp)
summary(comp)
summary(comp$PC1)
data$con_org<- comp$PC1
comp_prin=subset(data,select=c("ONU", "OEA", "FMI"))
comp_prin = na.omit(comp_prin)
library(polycor)
library(psych)
str(comp_prin)
cor(comp_prin)
library(corrplot)
corrplot(cor(comp_prin))
corrplot(cor(comp_prin), # Matriz de correlación
method = "shade", # Método para el gráfico de correlación
type = "full", # Estilo del gráfico (también "upper" y "lower")
diag = TRUE, # Si TRUE (por defecto), añade la diagonal
tl.col = "black", # Color de las etiquetas
bg = "white", # Color de fondo
title = "",
col = NULL)
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
library(car)
# Q82: OEA
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
table(data$OEA)
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
library(car)
# Q82: OEA
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
library(car)
# Q82: OEA
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
table(data$OEA)
# Q83: Naciones Unidas
table(data$`Q83: Confidence: The United Nations (UN)`)
data$`Q83: Confidence: The United Nations (UN)`[data$`Q83: Confidence: The United Nations (UN)` == "-1"] <- NA
data$`Q83: Confidence: The United Nations (UN)`[data$`Q83: Confidence: The United Nations (UN)` == "-2"] <- NA
data$`Q83: Confidence: The United Nations (UN)`[data$`Q83: Confidence: The United Nations (UN)` == "-5"] <- NA
data$ONU <- recode(data$`Q83: Confidence: The United Nations (UN)`, "1=4; 2=3; 3=2;4=1")
table(data$ONU)
# Q84: Fondo Monetario Internacional
table(data$`Q84: Confidence: International Monetary Found (IMF)`)
data$`Q84: Confidence: International Monetary Found (IMF)`[data$`Q84: Confidence: International Monetary Found (IMF)` == "-1"] <- NA
data$`Q84: Confidence: International Monetary Found (IMF)`[data$`Q84: Confidence: International Monetary Found (IMF)` == "-2"] <- NA
data$FMI <- recode(data$`Q84: Confidence: International Monetary Found (IMF)`, "1=4; 2=3; 3=2;4=1")
table(data$FMI)
library(car)
str(data$`Q260: Sex`)
data$`Q260: Sex`=as.factor(data$`Q260: Sex`)
levels(data$`Q260: Sex`)=c("Hombre","Mujer")
data$sexo <- (data$`Q260: Sex`)
table(data$sexo)
str(data$`Q262: Age`)
data$Edad <- (data$`Q262: Age`)
summary(data$Edad)
table(data$`Q288R: Income level (Recoded)`)
data$`Q288R: Income level (Recoded)`[data$`Q288R: Income level (Recoded)` == "-1"] <- NA
data$`Q288R: Income level (Recoded)`[data$`Q288R: Income level (Recoded)` == "-2"] <- NA
data$`Q288R: Income level (Recoded)`=as.ordered(data$`Q288R: Income level (Recoded)`)
levels(data$`Q288R: Income level (Recoded)`) = c("Bajo", "Medio", "Alto")
data$Ingresos <- (data$`Q288R: Income level (Recoded)`)
table(data$Ingresos)
table(data$`Q275R: Highest educational level: Respondent`)
str(data$`Q275R: Highest educational level: Respondent`)
data$`Q275R: Highest educational level: Respondent`[data$`Q275R: Highest educational level: Respondent` == "-2"] <- NA
data$`Q275R: Highest educational level: Respondent`[data$`Q275R: Highest educational level: Respondent`== "-1"] <- NA
data$educacion=as.ordered(data$`Q275R: Highest educational level: Respondent`)
levels(data$educacion)
levels(data$educacion)<-c("Primario","Secundario","Post-secundario")
summary(data$educacion)
table(data$`Q240: Left-right political scale`)
data$`Q240: Left-right political scale`[data$`Q240: Left-right political scale` == "-1"] <- NA
data$`Q240: Left-right political scale`[data$`Q240: Left-right political scale` == "-2"] <- NA
data$Ideologia <- recode(data$`Q240: Left-right political scale`, "1:4=1; 5:6=2;7:10=3")
data$Ideologia=as.factor(data$Ideologia)
levels(data$Ideologia)=c("Izquierda","Centro","Derecha")
table(data$Ideologia)
table(data$`Q199: Interest in politics`)
data$`Q199: Interest in politics`[data$`Q199: Interest in politics` == "-1"] <- NA
data$interes_pol <- recode(data$`Q199: Interest in politics`, "1=4; 2=3; 3=2;4=1")
data$interes_pol=as.factor(data$interes_pol)
levels(data$interes_pol)=c("Nada", "Poco", "Algo", "Mucho")
table(data$interes_pol)
str(data$`Q146: Worries: A war involving my country`)
table(data$`Q146: Worries: A war involving my country`)
data$`Q146: Worries: A war involving my country`[data$`Q146: Worries: A war involving my country` == "-1"] <- NA
data$`Q146: Worries: A war involving my country`[data$`Q146: Worries: A war involving my country` == "-2"] <- NA
data$preo_guerra <- recode(data$`Q146: Worries: A war involving my country`, "1=4; 2=3; 3=2;4=1")
data$preo_guerra=as.factor(data$preo_guerra)
levels(data$preo_guerra)=c("Nada", "Poco", "Bastante", "Mucho")
table(data$preo_guerra)
str(data$`Q48: How much freedom of choice and control`)
data$`Q48: How much freedom of choice and control`[data$`Q48: How much freedom of choice and control` == "-2"] <- NA
data$`Q48: How much freedom of choice and control`[data$`Q48: How much freedom of choice and control` == "-1"] <- NA
data$lib_con=as.ordered(data$`Q48: How much freedom of choice and control`)
summary(data$lib_con)
str(data$`Q149: Freedom and Equality`)
data$`Q149: Freedom and Equality`[data$`Q149: Freedom and Equality` == "-1"] <- NA
data$`Q149: Freedom and Equality`[data$`Q149: Freedom and Equality` == "-2"] <- NA
data$`Q149: Freedom and Equality`[data$`Q149: Freedom and Equality` == "-4"] <- NA
data$`Q149: Freedom and Equality`[data$`Q149: Freedom and Equality` == "-5"] <- NA
data$lib_igualdad=as.factor(data$`Q149: Freedom and Equality`)
levels(data$lib_igualdad)
levels(data$lib_igualdad)<-c("Libertad","Igualdad")
summary(data$lib_igualdad)
str(data$`Q150: Freedom and security - Which more important`)
data$`Q150: Freedom and security - Which more important` [data$`Q150: Freedom and security - Which more important` == "-1"] <- NA
data$`Q150: Freedom and security - Which more important`[data$`Q150: Freedom and security - Which more important` == "-2"] <- NA
data$`Q150: Freedom and security - Which more important`[data$`Q150: Freedom and security - Which more important` == "-4"] <- NA
data$data$`Q150: Freedom and security - Which more important`[data$`Q150: Freedom and security - Which more important` == "-5"] <- NA
data$lib_seguridad=as.factor(data$`Q150: Freedom and security - Which more important`)
levels(data$lib_seguridad)
levels(data$lib_seguridad)<-c("Libertad","Seguridad")
summary(data$lib_seguridad)
str(data$`Q152: Aims of country: first choice`)
data$`Q152: Aims of country: first choice`  [data$`Q152: Aims of country: first choice` == "-1"] <- NA
data$`Q152: Aims of country: first choice` [data$`Q152: Aims of country: first choice` == "-2"] <- NA
data$`Q152: Aims of country: first choice`[data$`Q152: Aims of country: first choice` == "-4"] <- NA
data$`Q152: Aims of country: first choice`[data$`Q152: Aims of country: first choice` == "-5"] <- NA
data$objetivos_pais=as.factor(data$`Q152: Aims of country: first choice`)
levels(data$objetivos_pais)
levels(data$objetivos_pais)<-c("Crecimiento economico alto","Defensas fuertes","Participacion ciudadana","Embellecer las ciudades")
summary(data$objetivos_pais)
str(data$`Q154: Aims of respondent: first choice`)
data$`Q154: Aims of respondent: first choice`[data$`Q154: Aims of respondent: first choice`== "-1"] <- NA
data$`Q154: Aims of respondent: first choice`[data$`Q154: Aims of respondent: first choice` == "-2"] <- NA
data$`Q154: Aims of respondent: first choice`[data$`Q154: Aims of respondent: first choice`== "-4"] <- NA
data$`Q154: Aims of respondent: first choice`[data$`Q154: Aims of respondent: first choice`== "-5"] <- NA
data$objetivos_encuestado=as.factor(data$`Q154: Aims of respondent: first choice`)
levels(data$objetivos_encuestado)
levels(data$objetivos_encuestado)<-c("Mantener el orden","Participacion en decisiones gubernamentales","Combatir el alza de precios", "Proteger la libertad de expresion")
summary(data$objetivos_encuestado)
table(data$`Q250: Importance of democracy`)
str(data$`Q250: Importance of democracy`)
data$`Q250: Importance of democracy`[data$`Q250: Importance of democracy` == "-2"] <- NA
data$`Q250: Importance of democracy`[data$`Q250: Importance of democracy` == "-1"] <- NA
data$democracia=as.ordered(data$`Q250: Importance of democracy`)
summary(data$democracia)
table(data$`Q259: Feel close to the world`)
str(data$`Q259: Feel close to the world`)
data$`Q259: Feel close to the world`[data$`Q259: Feel close to the world` == "-2"] <- NA
data$`Q259: Feel close to the world`[data$`Q259: Feel close to the world` == "-1"] <- NA
data$`Q259: Feel close to the world`[data$`Q259: Feel close to the world` == "-4"] <- NA
data$`Q259: Feel close to the world`[data$`Q259: Feel close to the world` == "-5"] <- NA
data$mundo=as.ordered(data$`Q259: Feel close to the world`)
levels(data$mundo)
levels(data$mundo)<-c("Muy cerca","Cerca","No muy cerca","Para nada cerca")
summary(data$mundo)
library(DescTools)
Mode(data$ONU,na.rm = T)
Median(data$ONU,na.rm = T)
hist(data$ONU, xlab = "Nivel de confianza", ylab = "Frecuencia", col = "darkolivegreen", main = "Histograma de confianza en la ONU")
Mode(data$FMI,na.rm = T)
Median(data$FMI,na.rm = T)
hist(data$FMI, main="Histograma de confianza en el FMI", xlab = "Nivel de confianza", ylab = "Frecuencia", col = "darkgoldenrod2")
table(data$OEA)
summary(data$OEA)
hist(data$OEA, main="Confianza en la OEA", xlab = "Nivel de confianza", ylab = "Frecuencia", col = "cyan4")
library(DescTools)
library(ggplot2)
table(data$sexo)
Mode(data$sexo, na.rm = T)
t0=as.data.frame(table(data$sexo))
#install.packages("lessR")
library(lessR)
PieChart(Var1, hole = 0, values = "%", data = t0,
fill = c("darkkhaki", "pink"), main = "Gráfico pie de sexo")
summary(data$Edad)
Mode(data$Edad, na.rm = T)
hist(data$Edad, main = "Histograma de la variable Edad", xlab = "Edad", ylab = "Frecuencia", col = "lightblue")
Mode(data$Ingresos, na.rm = T)
table(data$Ingresos)
tabla_ingresos=table(data$Ingresos)
tabla_ingresos1=prop.table(tabla_ingresos)*100
round(tabla_ingresos1, digits = 2)
barplot(tabla_ingresos1, main = "Gráfico de Barras de ingresos",
xlab = "Nivel de ingresos",
ylab = "Porcentaje", col = "aquamarine3", border = "darkgreen")
summary(data$Ideologia)
tabla_ideologia=table(data$Ideologia)
tabla_ideologia1=prop.table(tabla_ideologia)*100
round(tabla_ideologia1, digits = 2)
barplot(tabla_ideologia1, main = "Gráfico de Barras",
xlab = "Ideología política",
ylab = "Porcentaje", col = "lightgreen", border = "darkgreen")
Mode(data$interes_pol, na.rm = T)
summary(data$interes_pol)
tabla_interes=table(data$interes_pol)
tabla_interes1=prop.table(tabla_interes)*100
round(tabla_interes1, digits = 2)
barplot(tabla_interes1, main = "Gráfico de barras de interés en la política",
xlab = "Interés en la política",
ylab = "Porcentaje", col = "darkgoldenrod3", border = "darkgoldenrod")
Mode(data$preo_guerra, na.rm = T)
tabla_preo=table(data$preo_guerra)
tabla_preo1=prop.table(tabla_preo)*100
round(tabla_preo1, digits = 2)
t3=as.data.frame(table(data$preo_guerra))
ggplot(t3,aes(x="Grado de preocupación por una guerra",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico de preocupación por una guerra")+xlab("") + ylab(" ")
library(DescTools)
Mode(data$lib_con,na.rm = T)
Median(data$lib_con,na.rm = T)
boxplot(data$`Q48: How much freedom of choice and control`, main="Boxplot de Libertad de elección y control", col = "darksalmon")
Mode(data$lib_igualdad,na.rm = T)
library(ggplot2)
t1=as.data.frame(table(data$lib_igualdad))
ggplot(t1,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable libertad o igualdad")+xlab("") + ylab(" ")
Mode(data$lib_seguridad,na.rm = T)
t2=as.data.frame(table(data$lib_seguridad))
barplot(table(data$lib_seguridad),col="pink",
xlab=NULL,
ylab="Conteo de encuestados",
main="libertad o seguridad")
Mode(data$objetivos_pais,na.rm = T)
t3=as.data.frame(table(data$objetivos_pais))
ggplot(t3,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable sobre los objetivos del país")+xlab("") + ylab(" ")
Mode(data$objetivos_encuestado,na.rm = T)
t4=as.data.frame(table(data$objetivos_encuestado))
ggplot(t4,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable objetivos de los encuestados")+xlab("") + ylab(" ")
Mode(data$democracia,na.rm = T)
Median(data$democracia,na.rm = T)
boxplot(data$democracia)
Mode(data$mundo,na.rm = T)
t5=as.data.frame(table(data$mundo))
ggplot(t5,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable proximidad al mundo")+xlab("") + ylab(" ")
Mode(data$educacion,na.rm = T)
t6=as.data.frame(table(data$educacion))
ggplot(t6,aes(x="identity",y=Freq, fill=Var1))+
geom_bar(stat = "identity",color="black")+
geom_text(aes(label=Freq),
position=position_stack(vjust=0.5))+coord_polar(theta="y")+ggtitle("Gráfico pie de la variable educación")+xlab("") + ylab(" ")
comp_prin=subset(data,select=c("ONU", "OEA", "FMI"))
library(polycor)
library(psych)
str(comp_prin)
cor(comp_prin)
library(corrplot)
corrplot(cor(comp_prin))
corrplot(cor(comp_prin), # Matriz de correlación
method = "shade", # Método para el gráfico de correlación
type = "full", # Estilo del gráfico (también "upper" y "lower")
diag = TRUE, # Si TRUE (por defecto), añade la diagonal
tl.col = "black", # Color de las etiquetas
bg = "white", # Color de fondo
title = "",
col = NULL)
# pruebas
library(psych)
psych::KMO(comp_prin)
corMatrix=cor(comp_prin)
cortest.bartlett(corMatrix,n=nrow(comp_prin))$p.value>0.05
fa.parallel(corMatrix, fm="pa", fa="pc", main = "Scree Plot")
comp_prin=subset(data,select=c("ONU", "OEA", "FMI"))
comp_prin = na.omit(comp_prin)
library(polycor)
library(psych)
str(comp_prin)
cor(comp_prin)
library(corrplot)
corrplot(cor(comp_prin))
corrplot(cor(comp_prin), # Matriz de correlación
method = "shade", # Método para el gráfico de correlación
type = "full", # Estilo del gráfico (también "upper" y "lower")
diag = TRUE, # Si TRUE (por defecto), añade la diagonal
tl.col = "black", # Color de las etiquetas
bg = "white", # Color de fondo
title = "",
col = NULL)
# pruebas
library(psych)
psych::KMO(comp_prin)
corMatrix=cor(comp_prin)
cortest.bartlett(corMatrix,n=nrow(comp_prin))$p.value>0.05
fa.parallel(corMatrix, fm="pa", fa="pc", main = "Scree Plot")
library(FactoMineR)
res.pca <- PCA(comp_prin, graph = FALSE)
library(FactoMineR)
library(factoextra)
fviz_pca_var(res.pca, col.var = "black",repel = TRUE)
eig.val <-get_eig(res.pca)
eig.val
comp1<- pca(comp_prin,nfactors = 1,rotate = "varimax")
comp<-as.data.frame(comp1$scores)
summary(comp$PC1)
data$con_org<- comp$PC1
data$con_org<- c(omp$PC1, na.omit=TRUE)
data$con_org<- (comp$PC1, na.omit=TRUE)
data = na.omit(data)
View(data)
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
library(car)
# Q82: OEA
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
library(car)
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
data=na.omit(data)
data=na.omit(data)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
summary(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- mean(`Q82_OAS: Confidence: The Organization of American States (OAE)`,na.rm=TRUE)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- mean(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`,na.rm=TRUE)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- mean(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`,na.rm=TRUE)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
data=na.omit(data)
summary(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
summary(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
library(car)
View(data)
View(data)
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
data=na.omit(data)
library(car)
# Q82: OEA
summary(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
setwd("~/Documents/GitHub/Ratatata")
library(rio)
WVS <-import("WVS_Peru.xlsx")
data=subset(WVS,select=c(`Q4: Important in life: Politics`, `Q48: How much freedom of choice and control`, `Q49: Satisfaction with your life`, `Q50: Satisfaction with financial situation of household`, `Q82_OAS: Confidence: The Organization of American States (OAE)`, `Q83: Confidence: The United Nations (UN)`, `Q84: Confidence: International Monetary Found (IMF)`, `Q146: Worries: A war involving my country`, `Q147: Worries: A terrorist attack`, `Q149: Freedom and Equality - Which more important`, `Q150: Freedom and security - Which more important`, `Q152: Aims of country: first choice`, `Q154: Aims of respondent: first choice`, `Q199: Interest in politics`, `Q240: Left-right political scale`, `Q250: Importance of democracy`, `Q259: Feel close to the world`, `Q260: Sex`, `Q262: Age`, `Q275R: Highest educational level: Respondent (recoded into 3 groups)`, `Q288R: Income level (Recoded)`))
data=na.omit(data)
summary(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
table(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`)
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-1"] <- NA
data$`Q82_OAS: Confidence: The Organization of American States (OAE)`[data$`Q82_OAS: Confidence: The Organization of American States (OAE)` == "-2"] <- NA
data$OEA <- recode(data$`Q82_OAS: Confidence: The Organization of American States (OAE)`, "1=4; 2=3; 3=2;4=1")
